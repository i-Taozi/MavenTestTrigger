webpackJsonp([2],{324:function(t,e,n){function a(t){n(355)}var r=n(15)(n(334),n(369),a,null,null);t.exports=r.exports},334:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(186),r=n(185),i=n(366),o=n.n(i);e.default={components:{vDetail:o.a},data:function(){return{filters:{id:""},total:0,page:1,tableHeight:"100%",tableLoading:!1,tableList:[],isShowForm:!1,data:{}}},methods:{handleCurrentChange:function(t){this.page=t,this.fetchList()},fetchList:function(){var t=this;t.tableHeight=document.getElementById("container").clientHeight-77-42-15;var e={offset:0,size:10,id:this.filters.id};e.offset=(t.page-1)*e.size,t.tableLoading=!0,n.i(r.a)("proRecList",e,t,function(e){t.tableLoading=!1;try{var r=(e.error,e.status,e.data);t.total=r.totalElements,t.tableList=r.content.map(function(t){return t.startTimeFormat=n.i(a.b)(new Date(Number(t.startTime)),"yyyy-MM-dd hh:mm:ss"),t.endTimeFormat=n.i(a.b)(new Date(Number(t.endTime)),"yyyy-MM-dd hh:mm:ss"),t})}catch(t){a.a.jsErrNotify(t)}})},resetSearch:function(){this.filters={id:""},this.fetchList()},showForm:function(t){this.isShowForm=!0,this.data=t},handleDel:function(t){var e=this;if(0==t.status)return void e.$message.error("请先下架");e.$confirm("此操作将删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.tableLoading=!0;var i=new Object;i.id=t.id,n.i(r.b)("proRecDelete",i,e,function(t){try{e.$message.success("删除成功"),e.fetchList()}catch(t){a.a.jsErrNotify(t)}})}).catch(function(){})},handleTop:function(t){var e=this,i=0==Number(t.isTop)?1:0,o=new Object;o.id=t.id,o.type=i,n.i(r.b)("proRecTop",o,e,function(t){try{t.error,t.status,t.data;e.$message.success("操作成功"),e.fetchList()}catch(t){a.a.jsErrNotify(t)}})},handleStatus:function(t){var e=this,i=0==Number(t.status)?1:0,o=new Object;o.id=t.id,o.type=i,n.i(r.b)("proRecOffLine",o,e,function(t){try{e.$message.success("操作成功"),e.fetchList()}catch(t){a.a.jsErrNotify(t)}})},handlePosition:function(t,e){var i=this,o=new Object;o.id=t.id,o.type=e,n.i(r.b)("proRecMove",o,i,function(t){try{i.$message.success("操作成功"),i.fetchList()}catch(t){a.a.jsErrNotify(t)}})}},mounted:function(){this.fetchList()}}},335:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(186),r=n(185);e.default={name:"vDetail",props:["value","data"],data:function(){var t=this,e=function(e,n,a){"0"==t.formData.type?0==t.formData.pid&&a(new Error("请输入商品ID")):""==t.formData.url&&a(new Error("请输入外链")),a()};return{value11:"",visible:!1,showLoading:!1,formTitle:"新增推荐",formLoading:!1,formRules:{title:[{required:!0,message:"请输入推荐标题",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],type:[{required:!0,message:"请输入推荐类型",trigger:"blur"}],pid:[{validator:e,trigger:"blur"}],url:[{validator:e,trigger:"blur"}]},formData:{id:"",title:"",type:"0",pid:0,url:"",coverUrl:"",coverId:"",startTime:"",endTime:""},inputVisible:!1,inputValue:"",avatarLoading:!1}},computed:{detail:function(){var t=this;if(!t.value)return!1;t.data.id&&t.visible&&(t.formTitle="编辑推荐",t.formData=t.data,t.data.startTime>0?t.formData.startTime=new Date(Number(t.data.startTime)):t.formData.startTime="",t.data.endTime>0?t.formData.endTime=new Date(Number(t.data.endTime)):t.formData.endTime="",t.formData.type=t.formData.type+"")}},methods:{formSubmit:function(){var t=this;if(!t.formData.coverId)return void t.$message.error("请上传推荐图片");if(!t.formData.startTime||!t.formData.endTime)return void t.$message.error("有效时间不能为空");var e=new Object;e.id=t.formData.id,e.title=t.formData.title,e.pid=t.formData.pid,e.url=t.formData.url,e.coverId=t.formData.coverId,e.startTime=n.i(a.b)(t.formData.startTime,"yyyy-MM-dd hh:mm:ss"),e.endTime=n.i(a.b)(t.formData.endTime,"yyyy-MM-dd hh:mm:ss"),e.type=t.formData.type,t.$refs.formData.validate(function(i){i&&(t.formLoading=!0,n.i(r.b)("proRecSave",e,t,function(e){t.formLoading=!1;try{t.$message.success("提交成功"),t.$refs.formData.resetFields(),t.visible=!1,t.$emit("refresh")}catch(t){a.a.jsErrNotify(t)}}))})},onSuccess:function(t,e){this.formData.coverUrl=URL.createObjectURL(e.raw),this.formData.coverId=t.data.id},resetFormData:function(){var t=this;t.formTitle="新增推荐",t.formData={id:"",title:"",type:"0",pid:0,url:"",coverUrl:"",coverId:"",startTime:"",endTime:""},t.data={}}},watch:{detail:function(t){},value:function(t){this.visible=t},visible:function(t){this.$emit("input",t)}},mounted:function(){this.value&&(this.visible=!0)}}},348:function(t,e,n){e=t.exports=n(316)(!0),e.push([t.i,".table-expand label{width:90px;color:#99a9bf}.table-expand .el-form-item{margin-right:0;margin-bottom:0;width:100%}","",{version:3,sources:["/Users/joeysin/IdeaWorkSpace/IdeaWorkSpaces/ZJ_store_admin/src/components/page/shelf/recommend.vue"],names:[],mappings:"AAsOA,oBACI,WAAY,AACZ,aAAe,CAClB,AACD,4BACI,eAAgB,AAChB,gBAAiB,AACjB,UAAY,CACf",file:"recommend.vue",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/*\n    表格展开部分样式\n*/\n.table-expand label {\n    width: 90px;\n    color: #99a9bf;\n}\n.table-expand .el-form-item {\n    margin-right: 0;\n    margin-bottom: 0;\n    width: 100%;\n}\n\n"],sourceRoot:""}])},355:function(t,e,n){var a=n(348);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n(317)("67be0b2b",a,!0)},366:function(t,e,n){var a=n(15)(n(335),n(375),null,null,null);t.exports=a.exports},369:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("el-col",{staticClass:"toolbar",attrs:{span:24}},[n("el-form",{attrs:{inline:!0,model:t.filters}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"请输入ID",icon:"circle-close","on-icon-click":t.resetSearch},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13))return null;t.fetchList(e)}},model:{value:t.filters.id,callback:function(e){t.filters.id=e},expression:"filters.id"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.fetchList()}}},[t._v("查询")])],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showForm("-1")}}},[t._v("新增推荐")])],1)],1)],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"table-expand",staticStyle:{width:"100%"},attrs:{data:t.tableList,stripe:"",border:"","max-height":t.tableHeight}},[n("el-table-column",{attrs:{prop:"id",label:"id",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"coverUrl",label:"推荐图",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!=e.row.coverUrl?n("img",{staticStyle:{width:"100%","vertical-align":"middle",margin:"10px auto"},attrs:{src:e.row.coverUrl,alt:""}}):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"title",label:"推荐标题"}}),t._v(" "),n("el-table-column",{attrs:{prop:"pid",label:"绑定商品ID"}}),t._v(" "),n("el-table-column",{attrs:{prop:"clickCount",label:"点击数"}}),t._v(" "),n("el-table-column",{attrs:{label:"有效时间",width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(e.row.startTimeFormat)+" - "+t._s(e.row.endTimeFormat)+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"290"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button-group",{staticClass:"mt-10"},[n("el-button",{attrs:{size:"small"},on:{click:function(n){t.handlePosition(e.row,1)}}},[t._v("上移")]),t._v(" "),n("el-button",{attrs:{size:"small"},on:{click:function(n){t.handlePosition(e.row,0)}}},[t._v("下移")]),t._v(" "),n("el-button",{attrs:{size:"small"},on:{click:function(n){t.showForm(e.row)}}},[t._v("编辑")])],1),t._v(" "),n("el-button-group",{staticClass:"mt-10"},[n("el-button",{attrs:{type:"success",size:"small"},on:{click:function(n){t.handleTop(e.row)}}},[t._v("置顶")]),t._v(" "),n("el-button",{attrs:{type:1==e.row.status?"success":"danger",size:"small"},on:{click:function(n){t.handleStatus(e.row)}}},[t._v("\n                        "+t._s(1==e.row.status?"上架":"下架")+"\n                    ")]),t._v(" "),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(n){t.handleDel(e.row)}}},[t._v("\n                        "+t._s(1==e.row.isDel?"恢复":"删除")+"\n                    ")])],1)]}}])})],1),t._v(" "),n("el-col",{staticClass:"mt-10",attrs:{span:24}},[n("el-pagination",{staticStyle:{float:"right"},attrs:{"page-size":10,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),n("v-detail",{attrs:{data:t.data},on:{refresh:t.fetchList},model:{value:t.isShowForm,callback:function(e){t.isShowForm=e},expression:"isShowForm"}})],1)},staticRenderFns:[]}},375:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:t.formTitle,value:t.value},on:{close:t.resetFormData},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("el-form",{ref:"formData",attrs:{model:t.formData,"label-width":"120px",rules:t.formRules}},[n("el-form-item",{attrs:{label:"推荐标题",prop:"title"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.title,callback:function(e){t.formData.title="string"==typeof e?e.trim():e},expression:"formData.title"}})],1),t._v(" "),n("el-form-item",{attrs:{required:"",label:"推荐类型",prop:"type"}},[""!=t.formData.id?n("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:t.formData.type,callback:function(e){t.formData.type=e},expression:"formData.type"}},[n("el-option",{attrs:{label:"商品",value:"0"}}),t._v(" "),n("el-option",{attrs:{label:"外链",value:"1"}})],1):n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData.type,callback:function(e){t.formData.type=e},expression:"formData.type"}},[n("el-option",{attrs:{label:"商品",value:"0"}}),t._v(" "),n("el-option",{attrs:{label:"外链",value:"1"}})],1)],1),t._v(" "),0==t.formData.type?n("el-form-item",{attrs:{label:"商品ID",prop:"pid"}},[n("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入商品ID"},model:{value:t.formData.pid,callback:function(e){t.formData.pid="string"==typeof e?e.trim():e},expression:"formData.pid"}})],1):n("el-form-item",{attrs:{label:"外链",prop:"url"}},[n("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入外链"},model:{value:t.formData.url,callback:function(e){t.formData.url="string"==typeof e?e.trim():e},expression:"formData.url"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"推荐图片",prop:"coverId"}},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/ks3/image_upload","show-file-list":!1,"on-success":t.onSuccess}},[t.formData.coverUrl?n("img",{staticClass:"avatar",attrs:{src:t.formData.coverUrl}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),n("el-form-item",{attrs:{label:"有效时间",required:""}},[n("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.formData.startTime,callback:function(e){t.formData.startTime=e},expression:"formData.startTime"}}),t._v("\n            至\n            "),n("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期时间"},model:{value:t.formData.endTime,callback:function(e){t.formData.endTime=e},expression:"formData.endTime"}})],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){t.visible=!1}}},[t._v("取消")]),t._v(" "),n("el-button",{attrs:{size:"small",type:"primary",loading:t.formLoading},nativeOn:{click:function(e){t.formSubmit(e)}}},[t._v("提交")])],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=2.8610532804f896c17436.js.map